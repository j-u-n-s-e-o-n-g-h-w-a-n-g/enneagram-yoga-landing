<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>로그인 | 에니어그램 요가</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400&family=Noto+Serif+KR:wght@200;300;400;500;600&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#f8f6f3;--text:#2c2c2c;--accent:#8a7968;--accent-light:#b8a99a;--border:#d4cdc4;--white:#fff;--section-bg:#f0ece7}
body{font-family:'Noto Serif KR',serif;color:var(--text);background:var(--bg);line-height:1.9;min-height:100vh;display:flex;flex-direction:column}
.eng{font-family:'Cormorant Garamond',serif;letter-spacing:0.08em}
nav{width:100%;background:rgba(248,246,243,0.95);backdrop-filter:blur(10px);border-bottom:1px solid var(--border);padding:0 40px}
nav .inner{max-width:1200px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;height:70px}
nav .logo{display:flex;align-items:center;text-decoration:none}
nav .logo img{height:36px;width:auto}
nav ul{list-style:none;display:flex;gap:36px}
nav ul li a{text-decoration:none;color:var(--text);font-size:0.75rem;letter-spacing:0.12em;text-transform:uppercase;font-family:'Cormorant Garamond',serif;font-weight:400;transition:color 0.3s}
nav ul li a:hover{color:var(--accent)}
.container{flex:1;display:flex;align-items:center;justify-content:center;padding:40px 20px}
.auth-box{max-width:420px;width:100%;padding:60px 40px;background:var(--white);border:1px solid var(--border)}
.auth-box h2{font-family:'Cormorant Garamond',serif;font-size:2rem;font-weight:300;text-align:center;margin-bottom:8px;letter-spacing:0.05em}
.auth-box .subtitle{text-align:center;font-size:0.8rem;color:#888;font-weight:300;margin-bottom:40px}
.form-group{margin-bottom:24px}
.form-group label{display:block;font-size:0.7rem;letter-spacing:0.2em;text-transform:uppercase;color:var(--accent);margin-bottom:8px;font-family:'Cormorant Garamond',serif}
.form-group input{width:100%;padding:12px 0;border:none;border-bottom:1px solid var(--border);background:transparent;font-family:'Noto Serif KR',serif;font-size:0.88rem;font-weight:300;color:var(--text);outline:none;transition:border-color 0.3s}
.form-group input:focus{border-bottom-color:var(--accent)}
.form-group input::placeholder{color:#ccc;font-weight:200}
.submit-btn{width:100%;padding:15px;border:1px solid var(--text);background:transparent;color:var(--text);font-family:'Cormorant Garamond',serif;font-size:0.85rem;letter-spacing:0.15em;text-transform:uppercase;cursor:pointer;transition:all 0.4s;margin-top:10px}
.submit-btn:hover{background:var(--text);color:var(--white)}
.auth-links{text-align:center;margin-top:24px;font-size:0.8rem;color:#888;font-weight:300}
.auth-links a{color:var(--accent);text-decoration:none;transition:color 0.3s}
.auth-links a:hover{color:var(--text)}
.error-msg{background:#fff5f5;border:1px solid #e8c4c4;color:#c44;padding:12px;font-size:0.8rem;text-align:center;margin-bottom:20px;display:none;font-weight:300}
.info-msg{background:var(--section-bg);border:1px solid var(--border);color:#666;padding:14px;font-size:0.78rem;text-align:center;margin-bottom:24px;font-weight:300;line-height:1.8}
footer{padding:40px;border-top:1px solid var(--border);text-align:center}
footer .logo-img{height:28px;width:auto;margin-bottom:8px}
footer p{font-size:0.7rem;color:#999;font-weight:300}
.hamburger{display:none;background:none;border:none;font-size:1.5rem;color:var(--text);cursor:pointer}
@media(max-width:768px){.hamburger{display:block}nav ul{display:none;position:absolute;top:100%;left:0;right:0;background:var(--white);border-bottom:1px solid var(--border);padding:20px;flex-direction:column;gap:12px}nav ul.open{display:flex}nav .logo img{height:28px}.auth-box{padding:40px 24px}}
</style>
</head>
<body>
<nav><div class="inner"><a href="/" class="logo"><img src="/images/signature.png" alt="Junseong Hwang"></a><ul><li><a href="/">Home</a></li></ul><button class="hamburger" onclick="toggleMenu()">&#9776;</button></div></nav>
<div class="container">
<div class="auth-box">
<h2 class="eng">Sign In</h2>
<p class="subtitle">계정에 로그인하세요</p>
<div class="info-msg">첫 수업신청이 완료된 분만 로그인 가능합니다.</div>
<div class="error-msg" id="errorMsg"></div>
<form id="loginForm">
<div class="form-group"><label class="eng">Email</label><input type="email" id="email" placeholder="이메일 주소" required></div>
<div class="form-group"><label class="eng">Password</label><input type="password" id="password" placeholder="비밀번호" required></div>
<button type="submit" class="submit-btn eng">Sign In</button>
</form>
<div style="text-align:center;margin-top:20px;padding-top:20px;border-top:1px solid var(--border)">
<p style="font-size:0.78rem;color:#888;margin-bottom:12px">비밀번호를 잊으셨나요?</p>
<div id="resetForm" style="display:none">
<input type="email" id="resetEmail" placeholder="가입시 이메일" style="width:100%;padding:12px;margin-bottom:8px;border:1px solid var(--border);font-family:'Noto Serif KR',serif;font-size:0.85rem;outline:none;box-sizing:border-box">
<input type="tel" id="resetPhone" placeholder="가입시 전화번호 (01012345678)" style="width:100%;padding:12px;margin-bottom:12px;border:1px solid var(--border);font-family:'Noto Serif KR',serif;font-size:0.85rem;outline:none;box-sizing:border-box">
<button type="button" onclick="resetPassword()" style="width:100%;padding:12px;border:1px solid var(--accent);background:transparent;color:var(--accent);font-family:'Cormorant Garamond',serif;font-size:0.85rem;letter-spacing:0.15em;cursor:pointer">임시 비밀번호 발급</button>
<p id="resetMsg" style="margin-top:8px;font-size:0.78rem;color:#888"></p>
</div>
<button type="button" onclick="document.getElementById('resetForm').style.display=document.getElementById('resetForm').style.display==='none'?'block':'none'" style="background:none;border:none;color:var(--accent);font-size:0.78rem;cursor:pointer;text-decoration:underline">비밀번호 재설정</button>
</div>
<div class="auth-links"><span style="font-size:0.78rem;color:#888">결제 완료 후 SMS로 받은 비밀번호로 로그인해주세요</span></div>
</div>
</div>
<footer><img class="logo-img" src="/images/signature.png" alt="Junseong Hwang"><p>&copy; 2026 Junseong Hwang. All rights reserved.</p></footer>
<script>
let csrfToken='';
fetch('/api/csrf-token').then(r=>r.json()).then(d=>{csrfToken=d.csrfToken}).catch(()=>{});
function apiFetch(url,opts={}){if(!opts.headers)opts.headers={};opts.headers['Content-Type']=opts.headers['Content-Type']||'application/json';if(csrfToken)opts.headers['X-CSRF-Token']=csrfToken;return fetch(url,opts);}
document.getElementById('loginForm').addEventListener('submit', async function(e) {
  e.preventDefault();
  const errorMsg = document.getElementById('errorMsg');
  errorMsg.style.display = 'none';
  try {
    const res = await apiFetch('/api/login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        email: document.getElementById('email').value,
        password: document.getElementById('password').value
      })
    });
    const data = await res.json();
    if (data.success) {
      if (data.user.role === 'admin') window.location.href = '/admin';
      else window.location.href = '/mypage';
    } else {
      errorMsg.textContent = data.error;
      errorMsg.style.display = 'block';
    }
  } catch (err) {
    errorMsg.textContent = '서버 연결에 실패했습니다';
    errorMsg.style.display = 'block';
  }
});
function toggleMenu(){document.querySelector('nav ul').classList.toggle('open');}
async function resetPassword(){
  const email=document.getElementById('resetEmail').value;
  const phone=document.getElementById('resetPhone').value;
  const msg=document.getElementById('resetMsg');
  if(!email||!phone){msg.textContent='이메일과 전화번호를 입력해주세요';msg.style.color='#c44';return;}
  msg.textContent='처리 중...';msg.style.color='#888';
  try{
    const res=await apiFetch('/api/reset-password',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email,phone})});
    const data=await res.json();
    if(data.success){msg.textContent='임시 비밀번호가 SMS로 발송되었습니다.';msg.style.color='#2e7d32';}
    else{msg.textContent=data.error||'오류가 발생했습니다';msg.style.color='#c44';}
  }catch(err){msg.textContent='오류가 발생했습니다';msg.style.color='#c44';}
}
</script>
</body>
</html>
